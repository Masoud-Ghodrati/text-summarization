NEW: Total of 39 hostages released after 22-hour siege.
Military official: Taliban has claimed responsibility for the incident.
Raging gunbattle leaves four gunmen and six guards dead.
