NEW: Student said to have had issue with geography teacher, state news channel reports.
A police officer and teacher were killed in the attack.
The gunman, said to be a student at the Moscow school, has been detained.
All of the hostages have been released; about 20 students were held, state media says.
