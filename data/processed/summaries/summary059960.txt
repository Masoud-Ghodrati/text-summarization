"It was very close to being a catastrophe," sheriff says.
A deputy underwent surgery after being shot in the leg.
Dennis Marx was armed with gas grenades, assault rifle, and spike strips, police say.
Sheriff: Carrying flexible handcuffs, he appeared intent on taking over courthouse.
