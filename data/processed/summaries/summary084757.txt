Rafael Nadal taken to three sets by David Ferrer in Madrid Masters.
Bidding for third title on the clay in Spanish capital.
Third seed Andy Murray beaten by Tomas Berdych.
Serena Williams and Maria Sharapova into last four of women's event.
