NEW: Defense Secretary Gates: Leaks should stop, because they might jeopardize probe.
Medical school classmates: Hasan espoused Islamist views in class.
Hasan said his allegiance was to Sharia law, not the U.S., source says.
Hasan charged with murder, accused of killing 13 at Fort Hood last week.
