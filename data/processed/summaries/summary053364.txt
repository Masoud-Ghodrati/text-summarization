A police sniper shoots James Lee after Lee aims a gun at hostages, police say.
Three hostages are unharmed, officials say.
Devices in backpacks held by Lee have to be rendered safe, police say.
A Discovery spokesman says the company knew of Lee, did not take his threats seriously.
